CREATE OR REPLACE PROCEDURE PHCDW_DEV.PHCDW_CDM.MONTHLY_STIVARGA_VC_LOT_REFRESH()
RETURNS STRING
LANGUAGE SQL
EXECUTE AS CALLER
AS '
BEGIN
    CREATE OR REPLACE TABLE PHCDW_DEV.PHCDW_CDM.VEEVA_COMPASS_STIVARGA_TAB AS
    (SELECT QUERY_ID, JOB_ID, RECORD_ID, RECORD_TYPE, PRESCRIPTION_NUM, CLAIM_ID, CHARGE_LINE_NUMBER, TRANSACTION_DATE, TRANSACTION_DAY, TRANSACTION_MONTH, TRANSACTION_YEAR, PATIENT_ID, AGE, YEAR_OF_BIRTH, GENDER, ZIP3, STATE, PRODUCT_ID, PRODUCT_NAME, PRODUCT_DESC, PRODUCT_CATEGORY, COMPOUND_NAME, TA1, TA2, TA3, OTC, STRENGTH, ACTIVE_INGREDIENT, COMPANY_NAME, ROUTE, DOSE_FORM, PRODUCT_J_CODE, OBSOLETE_DATETIME, FILL_NUMBER, NUM_AUTHORIZED_REFILLS, DAYS_SUPPLY, QTY_DISPENSED, UNITS_OF_SERVICE, UNIT_OF_MEASURE, UNIT_OF_MEASURE_DESC, LINE_CHARGES, PLACE_OF_SERVICE, PLACE_OF_SERVICE_DESC, TELEHEALTH, HCP_ID, HCP_VID, HCP_SPECIALTY_1, HCP_SPECIALTY_2, REFERRING_HCP_NPI, REFERRING_HCP_VID, REFERRING_HCP_SPECIALTY_1, REFERRING_HCP_SPECIALTY_2, FACILITY_NPI, FACILITY_VID, BILLING_PROVIDER_NPI, BILLING_PROVIDER_VID, PROCEDURE_CODE, PROCEDURE_CODE_DESC, PROCEDURE_CODE_MODIFIER1, DIAGNOSIS_CODE_1, DIAGNOSIS_CODE_2, DIAGNOSIS_CODE_3, DIAGNOSIS_CODE_4, DIAGNOSIS_CODE_1_DESC, DIAGNOSIS_CODE_2_DESC, DIAGNOSIS_CODE_3_DESC, DIAGNOSIS_CODE_4_DESC, DIAGNOSIS1_CLASS1, DIAGNOSIS1_CLASS2, DIAGNOSIS2_CLASS1, DIAGNOSIS2_CLASS2, DIAGNOSIS3_CLASS1, DIAGNOSIS3_CLASS2, DIAGNOSIS4_CLASS1, DIAGNOSIS4_CLASS2, DIAGNOSIS_ICDTYPE, PAYER_NAME_PRIMARY, PAYER_NAME_SECONDARY, PAYMENT_TYPE_PRIMARY, PAYMENT_TYPE_SECONDARY, PAYMENT_SUBTYPE_PRIMARY, PAYMENT_SUBTYPE_SECONDARY, PAYER_AMOUNT_PAID_PRIMARY, PAYER_AMOUNT_PAID_SECONDARY, PATIENT_PAY_AMOUNT, NUM_PAYERS FROM CPH_DB_CLONE_DAYLIGHT_PROD_DAYLIGHT_SHARE_DEV.MODEL_V2.FACT_CLAIMS_STIVARGA_HIST WHERE TRANSACTION_YEAR < 2021 LIMIT 1000)
    UNION ALL
    (SELECT QUERY_ID, JOB_ID, RECORD_ID, RECORD_TYPE, PRESCRIPTION_NUM, CLAIM_ID, CHARGE_LINE_NUMBER, TRANSACTION_DATE, TRANSACTION_DAY, TRANSACTION_MONTH, TRANSACTION_YEAR, PATIENT_ID, AGE, YEAR_OF_BIRTH, GENDER, ZIP3, STATE, PRODUCT_ID, PRODUCT_NAME, PRODUCT_DESC, PRODUCT_CATEGORY, COMPOUND_NAME, TA1, TA2, TA3, OTC, STRENGTH, ACTIVE_INGREDIENT, COMPANY_NAME, ROUTE, DOSE_FORM, PRODUCT_J_CODE, OBSOLETE_DATETIME, FILL_NUMBER, NUM_AUTHORIZED_REFILLS, DAYS_SUPPLY, QTY_DISPENSED, UNITS_OF_SERVICE, UNIT_OF_MEASURE, UNIT_OF_MEASURE_DESC, LINE_CHARGES, PLACE_OF_SERVICE, PLACE_OF_SERVICE_DESC, TELEHEALTH, HCP_ID, HCP_VID, HCP_SPECIALTY_1, HCP_SPECIALTY_2, REFERRING_HCP_NPI, REFERRING_HCP_VID, REFERRING_HCP_SPECIALTY_1, REFERRING_HCP_SPECIALTY_2, FACILITY_NPI, FACILITY_VID, BILLING_PROVIDER_NPI, BILLING_PROVIDER_VID, PROCEDURE_CODE, PROCEDURE_CODE_DESC, PROCEDURE_CODE_MODIFIER1, DIAGNOSIS_CODE_1, DIAGNOSIS_CODE_2, DIAGNOSIS_CODE_3, DIAGNOSIS_CODE_4, DIAGNOSIS_CODE_1_DESC, DIAGNOSIS_CODE_2_DESC, DIAGNOSIS_CODE_3_DESC, DIAGNOSIS_CODE_4_DESC, DIAGNOSIS1_CLASS1, DIAGNOSIS1_CLASS2, DIAGNOSIS2_CLASS1, DIAGNOSIS2_CLASS2, DIAGNOSIS3_CLASS1, DIAGNOSIS3_CLASS2, DIAGNOSIS4_CLASS1, DIAGNOSIS4_CLASS2, DIAGNOSIS_ICDTYPE, PAYER_NAME_PRIMARY, PAYER_NAME_SECONDARY, PAYMENT_TYPE_PRIMARY, PAYMENT_TYPE_SECONDARY, PAYMENT_SUBTYPE_PRIMARY, PAYMENT_SUBTYPE_SECONDARY, PAYER_AMOUNT_PAID_PRIMARY, PAYER_AMOUNT_PAID_SECONDARY, PATIENT_PAY_AMOUNT, NUM_PAYERS FROM CPH_DB_CLONE_DAYLIGHT_PROD_DAYLIGHT_SHARE_DEV.MODEL_V2.FACT_VEEVA_COMPASS_STIVARGA LIMIT 1000);

END;
';